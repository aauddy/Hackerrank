Problem link: https://www.hackerrank.com/challenges/harry-potter-and-wands/problem

Solution:

SELECT W.ID, P.AGE, W.COINS_NEEDED, W.POWER 
FROM WANDS W inner join WANDS_PROPERTY P 
ON W.CODE = P.CODE 
AND P.IS_EVIL = 0
AND W.COINS_NEEDED = (select min(coins_needed) from wands x where x.code = w.code and x.power = w.power)
GROUP BY P.AGE, W.COINS_NEEDED, W.ID, W.POWER 
ORDER BY W.POWER DESC, P.AGE DESC;
